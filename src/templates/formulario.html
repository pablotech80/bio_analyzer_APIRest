{% extends 'base.html' %}
{% block title %}BioAnalyze | Formulario{% endblock %}

{% block content %}
<div class="text-center mb-4">

    {% if error %}
    <div class="alert alert-danger text-center">
        {{ error }}
    </div>
    {% endif %}

    <img src="{{ url_for('static', filename='img/bio_analyze.jpg') }}" alt="BioAnalyze Logo" width="200" class="rounded-circle">
    <h1 class="mt-3">Bienvenido a <span class="text-info">BioAnalyze</span></h1>
    <p class="lead">
        Ingresa tus datos f铆sicos y biom茅tricos para obtener un informe detallado de tu composici贸n corporal.<br>
        Nuestro sistema utiliza f贸rmulas cient铆ficas de referencia y ofrece interpretaciones personalizadas para guiar tu nutrici贸n, entrenamiento y salud general.
    </p>
</div>

<form method="POST" action="/informe_web" class="row g-4">

    <!-- Secci贸n: Datos Personales -->
    <div class="col-12">
        <h6 class="form-section-title text-info border-bottom pb-1"> Datos Personales</h6>
    </div>

    <div class="col-md-3">
        <label for="edad" class="form-label">Edad</label>
        <input type="number" class="form-control form-control-sm form-mini" id="edad" name="edad" value="{{ form_data.get('edad', '') }}">
    </div>

    <div class="col-md-3">
        <label for="genero" class="form-label">G茅nero</label>
        <select class="form-select form-select-sm form-mini" id="genero" name="genero">
            <option value="">Seleccionar</option>
            <option value="h" {% if form_data.get('genero') == 'h' %}selected{% endif %}>Masculino</option>
            <option value="m" {% if form_data.get('genero') == 'm' %}selected{% endif %}>Femenino</option>
        </select>
    </div>

    <!-- Secci贸n: Medidas Corporales -->
    <div class="col-12">
         <h6 class="form-section-title text-info border-bottom pb-1"> Medidas Corporales</h6>
    </div>

    <div class="col-md-3">
        <label for="peso" class="form-label">Peso (kg)</label>
        <input type="number" step="0.1" class="form-control form-control-sm form-mini" id="peso" name="peso" value="{{ form_data.get('peso', '') }}">
    </div>

    <div class="col-md-3">
        <label for="altura" class="form-label">Altura (cm)</label>
        <input type="number" class="form-control form-control-sm form-mini" id="altura" name="altura" value="{{ form_data.get('altura', '') }}">
    </div>

    <div class="col-md-3">
        <label for="cuello" class="form-label">Cuello (cm)</label>
        <input type="number" class="form-control form-control-sm form-mini" id="cuello" name="cuello" value="{{ form_data.get('cuello', '') }}">
    </div>

    <div class="col-md-3">
        <label for="cintura" class="form-label">Cintura (cm)</label>
        <input type="number" class="form-control form-control-sm form-mini" id="cintura" name="cintura" value="{{ form_data.get('cintura', '') }}">
    </div>

    <div class="col-md-3" id="grupo-cadera">
        <label for="cadera" class="form-label">Cadera (cm) <span class="text-muted">(solo mujeres)</span></label>
        <input type="number" class="form-control form-control-sm form-mini" id="cadera" name="cadera" value="{{ form_data.get('cadera', '') }}">
    </div>

    <!-- Secci贸n: Objetivo -->
    <div class="col-12">
         <h6 class="form-section-title text-info border-bottom pb-1"> Objetivo</h6>
    </div>

    <div class="col-md-4">
        <label for="objetivo" class="form-label">Objetivo</label>
        <select class="form-select form-select-sm form-mini" id="objetivo" name="objetivo">
            <option value="">Seleccionar</option>
            <option value="mantener peso" {% if form_data.get('objetivo') == 'mantener peso' %}selected{% endif %}>Mantener peso</option>
            <option value="perder grasa" {% if form_data.get('objetivo') == 'perder grasa' %}selected{% endif %}>Perder grasa</option>
            <option value="ganar masa muscular" {% if form_data.get('objetivo') == 'ganar masa muscular' %}selected{% endif %}>Ganar masa muscular</option>
        </select>
    </div>

    <!-- Botones -->
    <div class="col-12 text-center mt-3">
        <button type="submit" class="btn btn-info px-4">Analizar</button>
        <a href="/informe_web" class="btn btn-outline-light ms-2">Limpiar</a>
    </div>

</form>

{% if resultados %}
<hr class="my-4">
    <div class="mt-4">
        <h2 class="text-success text-center mb-4">Resultados del An谩lisis</h2>

        <div class="row g-4">
            {% for key, value in resultados.items() %}
                {% if key != 'macronutrientes' and key != 'peso_saludable' %}
                    <div class="col-md-6">
                        <div class="card bg-dark text-light shadow">
                            <div class="card-body">
                                <h5 class="card-title">{{ key | replace('_', ' ') | capitalize }}: {{ value }}</h5>
                                {% if interpretaciones[key] is defined %}
                                    <p class="card-text text-info">{{ interpretaciones[key] }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}

            <!-- Macronutrientes -->
            <div class="col-md-6">
                <div class="card bg-dark text-light shadow">
                    <div class="card-body">
                        <h5 class="card-title">Macronutrientes diarios</h5>
                        <p class="card-text">
                            Prote铆nas: {{ resultados.macronutrientes.proteinas }} g<br>
                            Carbohidratos: {{ resultados.macronutrientes.carbohidratos }} g<br>
                            Grasas: {{ resultados.macronutrientes.grasas }} g
                        </p>
                    </div>
                </div>
            </div>

            <!-- Peso saludable -->
            <div class="col-md-6">
                <div class="card bg-dark text-light shadow">
                    <div class="card-body">
                        <h5 class="card-title">Peso Saludable Estimado</h5>
                        <p class="card-text">
                            M铆nimo: {{ resultados.peso_saludable.min }} kg<br>
                            M谩ximo: {{ resultados.peso_saludable.max }} kg
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center mt-5">
            <button class="btn btn-secondary" disabled>Generar Informe (Pr贸ximamente)</button>
        </div>
    </div>
{% endif %}
{% endblock %}