{% extends "base.html" %}

{% block title %}Detalle de análisis{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="container my-5">
        <div class="row">
            <div class="col-xl-8 col-lg-9 mx-auto">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h1 class="h3 mb-1">Detalle del análisis</h1>
                        <p class="text-muted mb-0">Generado el {{ analysis.created_at.strftime('%d/%m/%Y a las %H:%M') }}.</p>
                    </div>
                    <div>
                        <a class="btn btn-outline-secondary rounded-pill me-2" href="{{ url_for('bioanalyze.history') }}">
                            <i class="fas fa-history me-1"></i>Historial
                        </a>
                        <a class="btn btn-primary rounded-pill" href="{{ url_for('bioanalyze.informe_web') }}">
                            <i class="fas fa-redo me-1"></i>Nuevo análisis
                        </a>
                    </div>
                </div>

                <!-- Card: Datos ingresados -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-light">
                        <h2 class="h5 mb-0">Datos ingresados</h2>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Peso</span>
                                        <div class="fw-bold">{{ analysis.weight and ('%.1f'|format(analysis.weight)) or '—' }} kg</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Altura</span>
                                        <div class="fw-bold">{{ analysis.height and ('%.1f'|format(analysis.height)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Edad</span>
                                        <div class="fw-bold">{{ analysis.age or '—' }}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Sexo</span>
                                        <div class="fw-bold text-capitalize">{{ analysis.gender or '—' }}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Cuello</span>
                                        <div class="fw-bold">{{ analysis.neck_circumference and ('%.1f'|format(analysis.neck_circumference)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Cintura</span>
                                        <div class="fw-bold">{{ analysis.waist_circumference and ('%.1f'|format(analysis.waist_circumference)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Cadera</span>
                                        <div class="fw-bold">{{ analysis.hip_circumference and ('%.1f'|format(analysis.hip_circumference)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Bíceps izq.</span>
                                        <div class="fw-bold">{{ analysis.biceps_izq and ('%.1f'|format(analysis.biceps_izq)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Bíceps der.</span>
                                        <div class="fw-bold">{{ analysis.biceps_der and ('%.1f'|format(analysis.biceps_der)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Muslo izq.</span>
                                        <div class="fw-bold">{{ analysis.muslo_izq and ('%.1f'|format(analysis.muslo_izq)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Muslo der.</span>
                                        <div class="fw-bold">{{ analysis.muslo_der and ('%.1f'|format(analysis.muslo_der)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Gemelo izq.</span>
                                        <div class="fw-bold">{{ analysis.gemelo_izq and ('%.1f'|format(analysis.gemelo_izq)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 col-md-4 col-lg-3">
                                <div class="card h-100 rounded-4 shadow-sm">
                                    <div class="card-body py-2 px-3 text-center">
                                        <span class="text-muted small">Gemelo der.</span>
                                        <div class="fw-bold">{{ analysis.gemelo_der and ('%.1f'|format(analysis.gemelo_der)) or '—' }} cm</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card: Composición corporal -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-light">
                        <h2 class="h5 mb-0">Composición corporal</h2>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mb-0">
                            <li><strong>IMC:</strong> {{ '%.2f'|format(analysis.bmi) }}</li>
                            <li><strong>% Grasa:</strong> {{ '%.2f'|format(analysis.body_fat_percentage) }}%</li>
                            <li><strong>Masa magra:</strong> {{ '%.2f'|format(analysis.lean_mass) }} kg</li>
                            <li><strong>Masa grasa:</strong> {{ '%.2f'|format(analysis.fat_mass) }} kg</li>
                            <li><strong>FFMI:</strong> {{ '%.2f'|format(analysis.ffmi) }}</li>
                            <li><strong>Agua corporal:</strong> {{ '%.2f'|format(analysis.body_water) }} L</li>
                        </ul>
                    </div>
                </div>

                <!-- Card: Metabolismo y ratios -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-light">
                        <h2 class="h5 mb-0">Metabolismo y ratios</h2>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mb-0">
                            <li><strong>TMB:</strong> {{ '%.2f'|format(analysis.bmr) }} kcal</li>
                            <li><strong>TDEE:</strong> {{ '%.2f'|format(analysis.tdee) }} kcal</li>
                            <li><strong>Calorías objetivo:</strong> {{ '%.2f'|format(analysis.maintenance_calories) }} kcal</li>
                            <li><strong>Ratio cintura-altura:</strong> {{ '%.2f'|format(analysis.waist_height_ratio) }}</li>
                            {% if analysis.waist_hip_ratio %}
                                <li><strong>RCC:</strong> {{ '%.2f'|format(analysis.waist_hip_ratio) }}</li>
                            {% endif %}
                            {% if analysis.metabolic_age %}
                                <li><strong>Edad metabólica:</strong> {{ '%.0f'|format(analysis.metabolic_age) }}</li>
                            {% endif %}
                        </ul>
                    </div>
                </div>

                <!-- Card: Macronutrientes -->
                {% if analysis.protein_grams or analysis.carbs_grams or analysis.fats_grams %}
                <div class="card shadow-sm mb-4 rounded-4">
                    <div class="card-header bg-light">
                        <h2 class="h5 mb-0">Macronutrientes recomendados</h2>
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-md-4 mb-3 mb-md-0">
                                <span class="text-muted d-block">Proteínas</span>
                                <strong>{{ analysis.protein_grams and ('%.0f'|format(analysis.protein_grams)) or '—' }} g</strong>
                            </div>
                            <div class="col-md-4 mb-3 mb-md-0">
                                <span class="text-muted d-block">Carbohidratos</span>
                                <strong>{{ analysis.carbs_grams and ('%.0f'|format(analysis.carbs_grams)) or '—' }} g</strong>
                            </div>
                            <div class="col-md-4">
                                <span class="text-muted d-block">Grasas</span>
                                <strong>{{ analysis.fats_grams and ('%.0f'|format(analysis.fats_grams)) or '—' }} g</strong>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Card: Interpretaciones -->
                <div class="card shadow-sm rounded-4">
                    <div class="card-header bg-light">
                        <h2 class="h5 mb-0">Interpretaciones</h2>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            {% for label, descripcion in interpretaciones.items() %}
                                {% if descripcion %}
                                    <li class="list-group-item">
                                        <strong class="text-capitalize">{{ label.replace('_', ' ') }}:</strong>
                                        <span class="d-block d-md-inline ms-md-2">{{ descripcion }}</span>
                                    </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
                    
                </div>
            </div>

            
        </div>
    </div>
</div>
{% endblock %}
